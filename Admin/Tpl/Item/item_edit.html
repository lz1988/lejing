<meta charset="utf-8" />
<script src="__ROOT__/Public/js/jquery-1.8.2.js" type="text/javascript"></script>
<script type="text/javascript" src="__ROOT__/Public/js/jquery.form.js"></script>
<style>
    span{
        cursor: pointer;
    }
.text {
	font-family: "微软雅黑 Regular", "微软雅黑";
	font-size: 14px;
	font-style: normal;
	font-weight: 400;
}

.ax_check {
	color: #333333;
	font-family: "Arial Normal", "Arial";
	font-size: 13px;
	font-style: normal;
	font-weight: 400;
	line-height: normal;
	text-align: left;
	margin-right: 10px;
	height:30px;
} 
.imgtu {
	width: 672px;
	height: 242px;
	margin-right: 0.5px;
	text-align: center;
	font-family: "微软雅黑 Regular", "微软雅黑";
	font-size: 14px;
	font-style: normal;
	font-weight: 400;
	float:left;
	background-color: #E4E4E4;
	border:1px solid #E4E4E4;
}

.imgtu_title {
    font-family: "微软雅黑 Regular","微软雅黑";
    font-size: 14px;
    font-style: normal;
    font-weight: 400;
    height: 30px;
    left: 20px;
    position: relative;
    top: 20px;
    width: 80px;
	float:left;
	background: #FFFFFF;//背景色  
}
.imgtu_title1 {
    font-family: "微软雅黑 Regular","微软雅黑";
    font-size: 14px;
    font-style: normal;
    font-weight: 400;
    height: 30px;
    left: 20px;
    position: relative;
    top: 20px;
    width: 80px;
	float:left;
	background: #E4E4E4;//背景色  
}
.imgtu_con {
	width: 680px;
	height: 190px;
	margin-top: 50px;
	text-align: center;
	font-family: "微软雅黑 Regular", "微软雅黑";
	font-size: 14px;
	font-style: normal;
	font-weight: 400;
	position: relative;
	background-color: #FFFFFF;
	border-left:1px solid #E4E4E4;
}
.imgtu_con_li {
	width: 120px;
	height: 150px;
	padding-left:15px;
	text-align: center;
	font-family: "微软雅黑 Regular", "微软雅黑";
	font-size: 14px;
	font-style: normal;
	font-weight: 400;
	position: relative;
	background-color: #FFFFFF;
	float:left;
}
.imgtu_con_li_top {
	width: 102px;
	height: 102px;
	top:20px;
	position: relative;
	border:1px solid #E4E4E4;
}
.imgtu_con_li_bottom {
	width: 102px;
	height: 50px;
	margin-top:30px;
	text-align: center;
	position: relative;
}
.btn{position: relative;overflow: hidden;margin-right: 4px;display:inline-block;*display:inline;padding:4px 10px 4px;font-size:14px;line-height:18px;*line-height:20px;color:#fff;text-align:center;vertical-align:middle;cursor:pointer;background-color:#5bb75b;border:1px solid #cccccc;border-color:#e6e6e6 #e6e6e6 #bfbfbf;border-bottom-color:#b3b3b3;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;}
.btn input {position: absolute;top: 0; right: 0;margin: 0;border: solid transparent;opacity: 0;filter:alpha(opacity=0); cursor: pointer;}

/*弹窗*/
.r_bg{ width: 100%; height: 100%;position: fixed; top: 0; left: 0; z-index: 67; display: none;}
.relation_box{width: 600px; height: auto;  margin: 0 auto; margin-top: 10%;  box-shadow: 0px 0px 15px #ddd}
.relation_box .widget{width: 600px; height: auto;background: #f2f2f2 }
.relation_box .widget-foot{ border: none;}
.relation_box td span{ color: #ff0000}
.relation_box table.table-bordered{ border-top: 1px solid #ddd}
.s_top{ margin-top: 10px;}

.relation_box .widget{ margin: 0 0;}
.relation_box .form-group{ float: left;}
.relation_box .col-lg-4{ width: 80px; padding-right: 0; padding-top: 5px;}
.relation_box .col-lg-8{ width: 150px;}

/*属性*/
.attrblock{list-style-type:none;color: #333333;width:100%;}
.attrblock li {width:100px; height:40px; line-height:40px; text-align:center;float:left;}
.attrblock li label{padding:0; margin:0;}
.attrblock li .cbox {width:25px;height:40px;float:left;}
.attrblock li .cbox input{margin:0 0;}
.attrblock li .gcolor{width:15px; height:15px; float:left; padding: 5px 0;}
.attrblock li .itext{font-size:14px;font-style: normal;font-weight: 400;width:60px;float:left}
</style>
<link href="__ROOT__/Public/Admin/css/list.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="__ROOT__/Public/Admin/kindeditor/themes/default/default.css" />
<link rel="stylesheet" href="__ROOT__/Public/Admin/kindeditor/plugins/code/prettify.css" />
	<script charset="utf-8" src="__ROOT__/Public/Admin/kindeditor/kindeditor.js"></script>
	<script charset="utf-8" src="__ROOT__/Public/Admin/kindeditor/lang/zh_CN.js"></script>
	<script charset="utf-8" src="__ROOT__/Public/Admin/kindeditor/plugins/code/prettify.js"></script>
<script src="__ROOT__/Public/Admin/js/formvalidator/formValidator-4.1.1.js" type="text/javascript" charset="UTF-8"></script> 
<script src="__ROOT__/Public/Admin/js/message/message_add.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript">


   KindEditor.ready(function(K) {
			var editor1 = K.create('textarea[name="detail"]', {
				cssPath : '__ROOT__/Public/Admin/kindeditor/plugins/code/prettify.css',
				uploadJson : '__ROOT__/Public/Admin/kindeditor/php/upload_json.php',
				fileManagerJson : '__ROOT__/Public/Admin/kindeditor/php/file_manager_json.php',
				allowFileManager : true,
				afterBlur : function() {
				this.sync();
				K.ctrl(document, 13, function() {
				K('form[name=myform]')[0].submit();
				});
				K.ctrl(this.edit.doc, 13, function() {
				K('form[name=myform]')[0].submit();
				});
				}
			});
			prettyPrint();
		});
</script>

<script type="text/javascript">
    //上传图片
	function img_upload(fileupload,showimgid,form){
		var showimg = $('#'+showimgid);
		if($("#"+form).length<=0){
			$("#"+fileupload).wrap('<form id="'+form+'" action="{:U('Item/action')}" method="post" enctype="multipart/form-data"></form>');
		}
		
    	$("#"+fileupload).unbind().change(function(){
    		$('#'+form).ajaxSubmit({
				dataType:  'json',
				success: function(data) {
					var img = "/Uploads/Item/"+data.pic;
					if(fileupload=="fileupload0"){
						showimg.html("<img src='"+img+"' style='width:620px;'>");
					}else if(fileupload.indexOf("colorupload")>=0){
						showimg.html("<img src='"+img+"' style='width:30px;height:30px;'>");
					}else{
						showimg.html("<img src='"+img+"' style='width:100px;height:100px;'>");
					}
					
					$("#"+fileupload+"_pic").val(img);
				},
				error:function(xhr){
					showimg.html("上传失败");
				}
			});
		});
	}

	// 载入图片
	function loadpic(id,pic,mode){
		//alert(fileupload+showimg);
		var showimg = $('#showimg'+id);
		if(mode==1){
			showimg.html("<img src='"+pic+"' style='max-width:620px;'>");
		}else if(mode==2){
			showimg.html("<img src='"+pic+"' style='width:100px;height:100px;'>");
		}
		$("#fileupload"+id+"_pic").val(pic);
		
	}
	
	var add_input='<input type="text" name="color[]" style="width:60px;" /> ';
	function add_color2(){
		$('#add_color').before(add_input);
	}
	
	function del_sel_item(_this){
		$(_this).parent().remove();
	}
	
	var add_item2='<div><input type="text" name="group_item[]" readonly="readonly" onclick="add_item(this)" style="width:250px;" /><input type="hidden" readonly="readonly" name="gruop_item_id[]" value="" /><a href="javascript:void(0)" onclick="del_sel_item(this)">删除</a></div>';
	function add_gruop_item(){
		$('#add_item2').before(add_item2);
	}
	var select_id = new Array();
	function add_item(_this){
		var res=window.showModalDialog("{:U('item/select_item')}",null,"dialogWidth:1000px;dialogHeight:600px;help:no;status:no");
		if(res!='undefined'){
			$(_this).val(res[1]+'  '+res[2]);
			$(_this).next().val(res[0]);
		}
	}
	
</script>
<div class="currentposition">
    <div>{$cur_menu} > {$cur_title}</div>
</div>
<div class="addclass">
<div class="addtopheight">&nbsp;</div>
<form name="upload" id="upload" method="POST" onsubmit="return check_from()" action="" enctype="multipart/form-data"> 
<table width="100%" class="addsearchClass" border="0" cellpadding="0" cellspacing="0">   

   <input type="hidden" name="item_id" value="{$arr['item_id']}" />
   <tr>
       <td width="10%" height="30" align="right" class="left_txt2"><span class="must">*</span>产品名称：</td>
       <td width="80%" ><div style="float:left;"><input type="text" id="item_name" size="50" name="item_name" value="{$arr['item_name']}" /></div><div class="note" style="float:left;" id="title2Tip"></div>
       </td>
   </tr>
    
   <!--<tr>
       <td width="10%" height="30" align="right" class="left_txt2"><span class="must">*</span>货号：</td>
       <td width="80%" ><div style="float:left;"><input type="text" id="item_no" size="50" name="item_no" value="{$arr['item_no']}" /></div><div class="note" style="float:left;" id="item_noTip"></div>
       </td>
   </tr>
   
   <tr>
       <td width="10%" height="30" align="right" class="left_txt2"><span class="must">*</span>型号：</td>
       <td width="80%" ><div style="float:left;"><input type="text" id="model" size="50" name="model" value="{$arr['model']}" /></div><div class="note" style="float:left;" id="item_noTip"></div>
       </td>
   </tr>
   
    
   <tr>
       <td height="10" align="right" class="left_txt2"><span class="must">*</span>色号：</td>
       <td>
       <div id="color">
       <input type="text" name="color_no" value="{$arr.color_no}" style="width:60px;" />
       </div>
       </td>
   </tr>
   
    <tr>
       <td height="10" align="right" class="left_txt2"><span class="must">*</span>镜框颜色：</td>
       <td>
       <div id="color">
       <input type="text" name="color" value="{$arr.color}" style="width:60px;" />-->
      <!-- <input type="text" name="color[]" style="width:60px;" />-->
       
      <!-- <input type="button" id="add_color" onclick="add_color2()" value="添加" />-->
     <!--  </div>
       </td>
   </tr>
  -->
   
   
   <!--<tr>
       <td height="10" align="right" class="left_txt2">品牌：</td>
       <td>
           <select name="brand">
           <option value="0">--请选择--</option>
           <foreach name="newstypearr" item="list">
           <eq name="list.pid" value="6"><option value="{$list.type_id}" <eq name="list.type_id" value="$arr.brand">selected</eq>>{$list.type_name}</option></eq>
           </foreach>
           </select>
       </td>
   </tr>-->
   
   <foreach name="Think.config.ITEM_SEARCH" item="list">
   <tr>
       <td height="10" align="right" class="left_txt2">{$list.name}：</td>
       <td>
           <if condition="($list.id neq 1) and ($list.id neq 4) and ($list.id neq 78) and ($list.id neq 84)">
           <select name="{$key}">
           <option value="0">--请选择--</option>
           <foreach name="newstypearr" item="list2" key="key2">
           <eq name="list2.pid" value="$list.id"><option value="{$list2.type_id}" <php>if($list2[type_id]==$arr[$key]){echo 'selected';}</php>>{$list2.type_name}</option></eq>
           </foreach>
           </select>
           <else />
           <foreach name="newstypearr" item="list2" key="key2">
           <eq name="list2.pid" value="$list.id">
           <input type="checkbox" name="<eq name='list.id' value='84'>shop_type[]<else />item_type[]</eq>" <in name="list2.type_id" value="$arr[$key]">checked</in> value="{$list2.type_id}" />{$list2.type_name}
           </eq>
           </foreach>           
           </if>
       </td>
   </tr>
   </foreach>
   
  <!-- <tr>
       <td height="10" align="right" class="left_txt2">尺码：</td>
       <td>
       <select name="item_size">
       <option value="0">请选择</option>
       <foreach name="Think.config.ITEM_SIZE" item="list">
       <option value="{$key}" <eq name="arr.item_size" value="$key">selected</eq>>{$list}</option>
       </foreach>
       </select>
       </td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">形状：</td>
       <td>
       <select name="item_shape">
       <option value="0">请选择</option>
       <foreach name="Think.config.ITEM_SHAPE" item="list">
       <option value="{$key}" <eq name="arr.item_shape" value="$key">selected</eq>>{$list}</option>
       </foreach>
       </select>
       </td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">原价：</td>
       <td><input type="text" value="{$arr['ori_price']}" name="ori_price" id="ori_price" size="60"/><span class="note"></span></td>
   </tr>-->
   
   <tr>
       <td height="10" align="right" class="left_txt2"><span class="must">*</span>销售价：</td>
       <td><input type="text" value="{$arr['item_price']}" name="item_price" id="item_price" size="60"/><span class="note"></span></td>
   </tr>
   
  <!-- <tr>
       <td height="10" align="right" class="left_txt2">套餐价：</td>
       <td><input type="text" value="{$arr['package_price']}" name="package_price" id="package_price" size="60"/><span class="note"></span></td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">积分：</td>
       <td><input type="text" value="{$arr['score']}" name="score" id="score" size="60"/><span class="note"></span></td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">眼宽尺寸：</td>
       <td><input type="text" value="{$arr['yk_size']}" name="yk_size" id="yk_size" size="60"/><span class="note"></span></td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">鼻梁宽：</td>
       <td><input type="text" value="{$arr['pl_width']}" name="pl_width" id="pl_width" size="60"/><span class="note"></span></td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">正面宽：</td>
       <td><input type="text" value="{$arr['zm_width']}" name="zm_width" id="zm_width" size="60"/><span class="note"></span></td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">镜框高度：</td>
       <td><input type="text" value="{$arr['yk_height']}" name="yk_height" id="yk_height" size="60"/><span class="note"></span></td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">内测宽：</td>
       <td><input type="text" value="{$arr['lc_width']}" name="lc_width" id="lc_width" size="60"/><span class="note"></span></td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">镜腿尺寸：</td>
       <td><input type="text" value="{$arr['jt_size']}" name="jt_size" id="jt_size" size="60"/><span class="note"></span></td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">产地：</td>
       <td><input type="text" value="{$arr['origin']}" name="origin" id="origin" size="60"/><span class="note"></span></td>
   </tr>-->
   
   <tr>
       <td width="10%" height="30" align="right" class="left_txt2">缩略图：</td>
       <td width="80%" >
           <!--<div id="updiv1hid" >
              <img src="{$arr['icon']}" id="upimage1" width="100" />
              <input type="file" name="images" id="images" />&nbsp;
         	  <input type="hidden" name="icon" value="{$arr['icon']}" id="icon" />
          	  <input type="button" name="buttonupload" id="fileId" class="buttonupload" value="上传"/></span>
           </div>  -->
           <div class="form-group">
											<div class="col-lg-6">
												<div class="imgtu">
												<div class="imgtu_title" id="tupian1" style="cursor:pointer;">本地图片</div>
												<div class="imgtu_con" id="tupian_con1">
												<div class="imgtu_con_li">

													<div class="imgtu_con_li_top"><span onclick="delpic(this)">删除</span><div id="showimg1"></div></div>
													<div class="imgtu_con_li_bottom"><div class="btn">
            <span>添加</span>&nbsp;&nbsp;

            <input id="fileupload1" type="file" name="mypic" onclick="img_upload('fileupload1','showimg1','form1')" />
        </div></div><input type="hidden" name="item_pic[]" id="fileupload1_pic">
												</div>
												<div class="imgtu_con_li">
													<div class="imgtu_con_li_top"><span onclick="delpic(this)">删除</span><div id="showimg2"></div></div>
													<div class="imgtu_con_li_bottom"><div class="btn">
            <span>添加</span>&nbsp;&nbsp;
            <input id="fileupload2" type="file" name="mypic" onclick="img_upload('fileupload2','showimg2','form2')">
        </div></div><input type="hidden" name="item_pic[]" id="fileupload2_pic">
												</div>
												<div class="imgtu_con_li">
													<div class="imgtu_con_li_top"><span onclick="delpic(this)">删除</span><div id="showimg3"></div></div>
													<div class="imgtu_con_li_bottom"><div class="btn">
            <span>添加</span>&nbsp;&nbsp;
            <input id="fileupload3" type="file" name="mypic" onclick="img_upload('fileupload3','showimg3','form3')">
        </div></div><input type="hidden" name="item_pic[]" id="fileupload3_pic">
												</div>
												<div class="imgtu_con_li">
													<div class="imgtu_con_li_top"><span onclick="delpic(this)">删除</span><div id="showimg4"></div></div>
													<div class="imgtu_con_li_bottom"><div class="btn">
            <span>添加</span>&nbsp;&nbsp;
            <input id="fileupload4" type="file" name="mypic" onclick="img_upload('fileupload4','showimg4','form4')">
        </div></div><input type="hidden" name="item_pic[]" id="fileupload4_pic">
												</div>
												<div class="imgtu_con_li">
													<div class="imgtu_con_li_top"><span onclick="delpic(this)">删除</span><div id="showimg5"></div></div>
													<div class="imgtu_con_li_bottom"><div class="btn">
            <span>添加</span>&nbsp;&nbsp;
            <input id="fileupload5" type="file" name="mypic" onclick="img_upload('fileupload5','showimg5','form5')">
        </div></div><input type="hidden" name="item_pic[]" id="fileupload5_pic">
												</div>
												</div>
												<div class="imgtu_con" id="tupian_con2" style="display:none;">
												
												</div>
												</div>
											</div>
										</div>
       </td>
   </tr>
    
  
  <!-- <tr>
       <td width="10%" height="30" align="right" class="left_txt2">关联同款商品：</td>
       <td width="80%" ><div style="float:left;">
       <input type="text" onclick="add_item(this)" readonly="readonly" id="gruop_item" size="3" name="gruop_item[]" value="{$arr['gruop_item']}" />
       <input type="hidden" readonly="readonly" name="gruop_item_id[]" value="" />
       
      <foreach name="brother_list" item="bro">
       <div><input type="text" onclick="add_item(this)" readonly="readonly" size="3" name="gruop_item[]" value="{$bro['item_name']}  {$bro['color']}" />
       <input type="hidden" readonly="readonly" name="gruop_item_id[]" value="{$bro['item_id']}" /><a href="javascript:void(0)" onclick="del_sel_item(this)">删除</a></div>
       </foreach>
       <input type="button" id="add_item2" onclick="add_gruop_item()" value="添加" />
       </div><div class="note" style="float:left;" id="inventoryTip"></div></td>
   </tr>-->
   
  
   
   <tr>
       <td width="10%" height="30" align="right" class="left_txt2">库存数：</td>
       <td width="80%" ><div style="float:left;"><input type="text" class="textcenter" id="inventory" size="3" name="inventory" value="{$arr['inventory']}" /></div><div class="note" style="float:left;" id="inventoryTip"></div></td>
   </tr>
    
  
   <tr>
       <td height="10" align="right" class="left_txt2"><span class="must">*</span>商品详情：</td>
       <td><div style="float:left;"><textarea name="detail" id="content" class="textarea" style="width:700px;height:400px;visibility:hidden;" >{$arr['detail']}</textarea></div><div class="note" style="float:left;" id="contentTip">*</div></td>
   </tr>
 
   <tr>
       <td width="10%" height="30" align="right" class="left_txt2">排序：</td>
       <td width="80%" ><div style="float:left;"><input type="text" class="textcenter" id="" size="3" name="sort" value="{$arr['sort']}" /></div><div class="note" style="float:left;" id="inventoryTip"></div></td>
   </tr>
   
   <tr>
       <td height="10" align="right" class="left_txt2">状态：</td>
       <td>
           <input type="radio" name="status" <if condition="'0' eq $arr['status']">checked</if> value="0" id="status" />下架&nbsp;&nbsp;&nbsp;&nbsp;
           <input type="radio" name="status" <if condition="($arr['status'] eq '1') OR ($arr['status'] eq '')">checked</if> value="1" id="status" />上架
       </td>
   </tr>

   <tr>
       <td height="10" align="right" class="left_txt2">组合类型：</td>
       <td>
           <input type="radio" name="assemble_type" <if condition="'1' eq $arr['assemble_type']">checked</if> value="1" id="assemble_type" />单品&nbsp;&nbsp;&nbsp;&nbsp;
           <input type="radio" name="assemble_type" <if condition="($arr['assemble_type'] eq '2') OR ($arr['assemble_type'] eq '')">checked</if> value="2" id="assemble_type" />组合
       </td>
   </tr>

   <tr>
       <td colspan="2">
          <div class="addoperation">
          <input type="submit" class="buttonsave" value="保存" name="sub_authority" />
          &nbsp;
          <input type="reset" class="buttoncancel" value="取消" onclick="javascript:history.go(-1);" name="B12" />
          </div>
       </td> 
   </tr>

</table>
</form>
<div>&nbsp;</div>
</div>
<script>
		<volist name="list_image" id="vo" key="k">
			loadpic("{$k}","{$vo['img_path']}",2);
		</volist>

        function delpic(o){
            $(o).parent().parent().remove();
        }
</script>
